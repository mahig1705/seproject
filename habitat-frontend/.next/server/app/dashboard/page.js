(()=>{var e={};e.id=702,e.ids=[702],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5203:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>a.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>g,tree:()=>c});var l=s(482),r=s(9108),i=s(2563),a=s.n(i),o=s(8300),n={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);s.d(t,n);let c=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9468)),"C:\\Users\\Mahi\\Downloads\\Habitat\\habitat-frontend\\src\\app\\dashboard\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6313)),"C:\\Users\\Mahi\\Downloads\\Habitat\\habitat-frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\Mahi\\Downloads\\Habitat\\habitat-frontend\\src\\app\\dashboard\\page.tsx"],u="/dashboard/page",x={require:s,loadChunk:()=>Promise.resolve()},g=new l.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6374:(e,t,s)=>{Promise.resolve().then(s.bind(s,2038))},5545:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,s(9224).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2038:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var l=s(2295),r=s(3729),i=s(5814),a=s(951),o=s(9956),n=s(793),c=s(4034),d=s(9895),u=s(5961),x=s(5674),g=s(5366),m=s(5545),p=s(3037),h=s(3490),f=s(1453),b=s(8243),j=s(783),N=s.n(j);function y(){let{user:e,hasRole:t}=(0,i.useAuth)(),[s,j]=(0,r.useState)({totalUsers:0,totalIssues:0,totalBills:0,totalVisitors:0,activeVisitors:0,pendingIssues:0,pendingBills:0,recentNotices:[],recentIssues:[]}),[y,v]=(0,r.useState)(!0),[D,C]=(0,r.useState)(null);return((0,r.useEffect)(()=>{let s=async()=>{try{console.log("\uD83D\uDCCA Fetching dashboard data..."),v(!0),C(null);let[s,l]=await Promise.all([b.E.getNotices({limit:5}),b.E.getIssues({page:1,limit:5})]);console.log("✅ Notices:",s),console.log("✅ Recent Issues:",l);let r=0,i=0,a=0,o=0,n=0,c=0,d=0;if(t([h.i4.SECURITY])){let e=await b.E.getVisitors({page:1,limit:1e3});console.log("\uD83D\uDEAA Security - Visitors:",e),o=e.length,n=e.filter(e=>!e.outTime).length,console.log(`✅ Security stats: total=${o}, active=${n}`)}if(t([h.i4.ADMIN,h.i4.COMMITTEE])){let[e,t,s,l]=await Promise.all([b.E.getUsers(),b.E.getBills({page:1,limit:1e3}),b.E.getIssues({page:1,limit:1e3}),b.E.getVisitors({page:1,limit:1e3})]);console.log("\uD83D\uDC51 Admin/Committee - Users:",e),console.log("\uD83D\uDCB3 Admin/Committee - Bills:",t),console.log("\uD83D\uDD27 Admin/Committee - Issues:",s),console.log("\uD83D\uDEAA Admin/Committee - Visitors:",l),r=e.data?.length||0,i=t.length,a=t.filter(e=>"Pending"===e.status).length,c=s.length,d=s.filter(e=>"open"===e.status).length,o=l.length,n=l.filter(e=>!e.outTime).length,console.log("✅ Admin/Committee stats:",{totalUsers:r,totalBills:i,pendingBills:a,totalIssues:c,pendingIssues:d,totalVisitors:o,activeVisitors:n})}if(t([h.i4.RESIDENT,h.i4.TENANT])){let t=e?._id;if(!t)throw Error("User ID not found");let[s,l,r]=await Promise.all([b.E.getIssues({reporter:t,page:1,limit:1e3}),b.E.getBills({userId:t,page:1,limit:1e3}),b.E.getVisitors({flatNumber:e?.flatNumber,page:1,limit:1e3})]);console.log("\uD83C\uDFE0 Resident/Tenant - Issues:",s),console.log("\uD83D\uDCB3 Resident/Tenant - Bills:",l),console.log("\uD83D\uDEAA Resident/Tenant - Visitors:",r),c=s.length,i=l.length,a=l.filter(e=>"Pending"===e.status).length,o=r.length,n=r.filter(e=>!e.outTime).length,console.log("✅ Resident/Tenant stats:",{totalIssues:c,totalBills:i,pendingBills:a,totalVisitors:o,activeVisitors:n})}j({totalUsers:r,totalBills:i,pendingBills:a,totalVisitors:o,activeVisitors:n,totalIssues:c,pendingIssues:d,recentNotices:s.data||[],recentIssues:l||[]}),console.log("\uD83D\uDCC8 Final dashboard stats:",{totalUsers:r,totalBills:i,pendingBills:a,totalVisitors:o,activeVisitors:n,totalIssues:c,pendingIssues:d})}catch(e){console.error("❌ Dashboard fetch error:",e),C(e.message||"Failed to load dashboard data")}finally{v(!1)}};e&&s()},[e,t]),D)?l.jsx(a.A,{children:l.jsx("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"text-center",children:[l.jsx(u.Z,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Dashboard"}),l.jsx("p",{className:"text-gray-600",children:D}),l.jsx(c.z,{onClick:()=>window.location.reload(),className:"mt-4",children:"Retry"})]})})}):y?l.jsx(a.A,{children:l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})})}):l.jsx(a.A,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg p-6 text-white",children:[(0,l.jsxs)("h1",{className:"text-2xl font-bold mb-2",children:["Welcome back, ",e?.name?.split(" ")[0],"!"]}),l.jsx("p",{className:"text-primary-100",children:"Here's what's happening in your society today."})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:(t([h.i4.ADMIN,h.i4.COMMITTEE])?[{title:"Total Users",value:s.totalUsers,icon:d.Z,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Total Issues",value:s.totalIssues,icon:u.Z,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Total Bills",value:s.totalBills,icon:x.Z,color:"text-green-600",bgColor:"bg-green-100"},{title:"Total Visitors",value:s.totalVisitors,icon:g.Z,color:"text-purple-600",bgColor:"bg-purple-100"}]:t([h.i4.RESIDENT,h.i4.TENANT])?[{title:"My Issues",value:s.totalIssues,icon:u.Z,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"My Bills",value:s.totalBills,icon:x.Z,color:"text-green-600",bgColor:"bg-green-100"},{title:"Pending Bills",value:s.pendingBills,icon:m.Z,color:"text-red-600",bgColor:"bg-red-100"},{title:"My Visitors",value:s.totalVisitors,icon:g.Z,color:"text-purple-600",bgColor:"bg-purple-100"}]:t([h.i4.SECURITY])?[{title:"Today's Visitors",value:s.totalVisitors,icon:g.Z,color:"text-purple-600",bgColor:"bg-purple-100"},{title:"Active Visitors",value:s.activeVisitors,icon:m.Z,color:"text-blue-600",bgColor:"bg-blue-100"}]:[]).map((e,t)=>l.jsx(o.Zb,{className:"h-full",children:l.jsx(o.aY,{className:"p-6 flex flex-col justify-between",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-500",children:e.title}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.value})]}),l.jsx("div",{className:`p-3 rounded-full ${e.bgColor}`,children:l.jsx(e.icon,{className:`w-6 h-6 ${e.color}`})})]})})},t))}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)(o.Zb,{className:"h-full flex flex-col",children:[l.jsx(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center space-x-2",children:[l.jsx(p.Z,{className:"w-5 h-5"}),l.jsx("span",{children:"Recent Notices"})]})}),(0,l.jsxs)(o.aY,{className:"flex-1 flex flex-col space-y-3",children:[s.recentNotices.length>0?s.recentNotices.map((e,t)=>(0,l.jsxs)("div",{className:"border-l-4 border-primary-500 pl-4",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:e.title}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.content}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(0,f.p6)(e.createdAt)})]},t)):l.jsx("p",{className:"text-gray-500 text-center py-4 flex-1 flex items-center justify-center",children:"No recent notices"}),l.jsx(N(),{href:"/notices",children:l.jsx(c.z,{variant:"outline",className:"w-full mt-auto",children:"View All Notices"})})]})]}),(0,l.jsxs)(o.Zb,{className:"h-full flex flex-col",children:[l.jsx(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center space-x-2",children:[l.jsx(u.Z,{className:"w-5 h-5"}),l.jsx("span",{children:"Recent Issues"})]})}),(0,l.jsxs)(o.aY,{className:"flex-1 flex flex-col space-y-3",children:[s.recentIssues.length>0?s.recentIssues.map((e,t)=>(0,l.jsxs)("div",{className:"flex justify-between items-start p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:e.title}),l.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),l.jsx(n.C,{variant:"open"===e.status?"warning":"resolved"===e.status?"success":"info",children:e.status})]},t)):l.jsx("p",{className:"text-gray-500 text-center py-4 flex-1 flex items-center justify-center",children:"No recent issues"}),l.jsx(N(),{href:"/issues",children:l.jsx(c.z,{variant:"outline",className:"w-full mt-auto",children:"View All Issues"})})]})]})]})]})})}},9468:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>r,default:()=>a});let l=(0,s(6843).createProxy)(String.raw`C:\Users\Mahi\Downloads\Habitat\habitat-frontend\src\app\dashboard\page.tsx`),{__esModule:r,$$typeof:i}=l,a=l.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),l=t.X(0,[550,694,783,638,328],()=>s(5203));module.exports=l})();