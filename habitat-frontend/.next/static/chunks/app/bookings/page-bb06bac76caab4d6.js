(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[926],{3008:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6141:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},9883:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2104:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1572:function(e,s,t){Promise.resolve().then(t.bind(t,5382))},5382:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var r=t(7437),n=t(2265),a=t(3779),l=t(3414),i=t(7418),c=t(6651),d=t(2278),o=t(9173),u=t(8584),x=t(200),h=t(4494),m=t(1633),g=t(6141),j=t(3008),p=t(2104),v=t(8203),f=t(9883),y=t(2169),N=t(5925);function b(){let{user:e,hasPermission:s}=(0,a.useAuth)(),[t,b]=(0,n.useState)([]),[E,k]=(0,n.useState)([]),[C,w]=(0,n.useState)([]),[A,D]=(0,n.useState)(!0),[P,S]=(0,n.useState)(""),[Z,I]=(0,n.useState)(""),[R,_]=(0,n.useState)("");(0,n.useEffect)(()=>{s("bookings:read")&&L()},[]);let L=async()=>{try{D(!0);let[e,s,t]=await Promise.all([m.E.getBookings(),m.E.getAmenities(),m.E.getTechnicians()]);b(e||[]),k((null==s?void 0:s.data)||[]),w(t||[])}catch(e){N.default.error("Failed to fetch data")}finally{D(!1)}},z=async(e,s)=>{try{await m.E.approveBooking(e,s),N.default.success("Booking ".concat(s)),L()}catch(e){N.default.error("Failed to update booking status")}},O=async()=>{if(!R){N.default.error("Please select an amenity first");return}try{let e={amenityId:R,startTime:new Date().toISOString(),endTime:new Date(Date.now()+36e5).toISOString()};await m.E.createBooking(e),N.default.success("Booking created successfully!"),L()}catch(t){var e,s;N.default.error((null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to create booking")}},T=t.filter(e=>{var s,t,r,n;let a=(null===(t=e.amenityId)||void 0===t?void 0:null===(s=t.name)||void 0===s?void 0:s.toLowerCase())||"",l=(null===(n=e.userId)||void 0===n?void 0:null===(r=n.name)||void 0===r?void 0:r.toLowerCase())||"",i=a.includes(P.toLowerCase())||l.includes(P.toLowerCase()),c=!Z||e.status===Z;return i&&c}),B=[{value:"",label:"All Status"},{value:h.gn.PENDING,label:"Pending"},{value:h.gn.APPROVED,label:"Approved"},{value:h.gn.REJECTED,label:"Rejected"},{value:h.gn.CANCELLED,label:"Cancelled"}],M=e=>{switch(e){case h.gn.PENDING:return"warning";case h.gn.APPROVED:return"success";case h.gn.REJECTED:return"danger";case h.gn.CANCELLED:default:return"default"}},F=e=>{switch(e){case h.gn.PENDING:return(0,r.jsx)(g.Z,{className:"w-4 h-4"});case h.gn.APPROVED:return(0,r.jsx)(j.Z,{className:"w-4 h-4"});case h.gn.REJECTED:return(0,r.jsx)(p.Z,{className:"w-4 h-4"});default:return(0,r.jsx)(v.Z,{className:"w-4 h-4"})}};return s("bookings:read")?(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Bookings"}),(null==e?void 0:e.role)==="resident"&&(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("select",{className:"border rounded px-3 py-2",value:R,onChange:e=>_(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Select Amenity"}),E.map(e=>(0,r.jsx)("option",{value:e._id,children:e.name},e._id))]}),(0,r.jsxs)(c.z,{onClick:O,children:[(0,r.jsx)(f.Z,{className:"w-4 h-4 mr-2"})," New Booking"]})]})]}),(0,r.jsx)(i.Zb,{children:(0,r.jsx)(i.aY,{className:"p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsx)(d.I,{placeholder:"Search bookings...",value:P,onChange:e=>S(e.target.value)}),(0,r.jsx)(o.P,{value:Z,onChange:e=>I(e.target.value),options:B})]})})}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsx)(i.Ol,{children:(0,r.jsxs)(i.ll,{children:["All Bookings (",T.length,")"]})}),(0,r.jsx)(i.aY,{children:A?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"})}):0===T.length?(0,r.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No bookings found"}):(0,r.jsxs)(x.iA,{children:[(0,r.jsx)(x.xD,{children:(0,r.jsxs)(x.SC,{children:[(0,r.jsx)(x.ss,{children:"User"}),(0,r.jsx)(x.ss,{children:"Amenity"}),(0,r.jsx)(x.ss,{children:"Start"}),(0,r.jsx)(x.ss,{children:"End"}),(0,r.jsx)(x.ss,{children:"Status"}),(0,r.jsx)(x.ss,{className:"text-right",children:"Actions"})]})}),(0,r.jsx)(x.RM,{children:T.map(s=>{var t,n;return(0,r.jsxs)(x.SC,{children:[(0,r.jsx)(x.pj,{children:(null===(t=s.userId)||void 0===t?void 0:t.name)||"—"}),(0,r.jsx)(x.pj,{children:(null===(n=s.amenityId)||void 0===n?void 0:n.name)||"—"}),(0,r.jsx)(x.pj,{children:(0,y.o0)(s.startTime)}),(0,r.jsx)(x.pj,{children:(0,y.o0)(s.endTime)}),(0,r.jsx)(x.pj,{children:(0,r.jsx)(u.C,{variant:M(s.status),children:(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[F(s.status),(0,r.jsx)("span",{children:s.status})]})})}),(0,r.jsxs)(x.pj,{className:"text-right space-x-2",children:[s.status===h.gn.PENDING&&(null==e?void 0:e.role)==="admin"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.z,{size:"sm",variant:"success",onClick:()=>z(s._id,h.gn.APPROVED),children:"Approve"}),(0,r.jsx)(c.z,{size:"sm",variant:"danger",onClick:()=>z(s._id,h.gn.REJECTED),children:"Reject"})]}),s.status===h.gn.APPROVED&&(null==e?void 0:e.role)==="resident"&&(0,r.jsx)(c.z,{size:"sm",variant:"outline",onClick:()=>z(s._id,h.gn.CANCELLED),children:"Cancel"})]})]},s._id)})})]})})]})]})}):(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,r.jsx)("p",{className:"text-gray-600",children:"You don't have permission to view this page."})]})})}},2278:function(e,s,t){"use strict";t.d(s,{I:function(){return a}});var r=t(7437);t(2265);var n=t(2169);let a=e=>{let{label:s,error:t,helperText:a,className:l,id:i,...c}=e,d=i||"input-".concat(Math.random().toString(36).substr(2,9));return(0,r.jsxs)("div",{className:"space-y-2",children:[s&&(0,r.jsx)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700",children:s}),(0,r.jsx)("input",{id:d,className:(0,n.cn)("w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",t&&"border-red-500 focus:ring-red-500",l),...c}),t&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:t}),a&&!t&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:a})]})}},9173:function(e,s,t){"use strict";t.d(s,{P:function(){return a}});var r=t(7437);t(2265);var n=t(2169);let a=e=>{let{label:s,error:t,helperText:a,options:l,className:i,id:c,...d}=e,o=c||"select-".concat(Math.random().toString(36).substr(2,9));return(0,r.jsxs)("div",{className:"space-y-2",children:[s&&(0,r.jsx)("label",{htmlFor:o,className:"block text-sm font-medium text-gray-700",children:s}),(0,r.jsx)("select",{id:o,className:(0,n.cn)("w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",t&&"border-red-500 focus:ring-red-500",i),...d,children:l.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}),t&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:t}),a&&!t&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:a})]})}},200:function(e,s,t){"use strict";t.d(s,{RM:function(){return i},SC:function(){return c},iA:function(){return a},pj:function(){return o},ss:function(){return d},xD:function(){return l}});var r=t(7437);t(2265);var n=t(2169);let a=e=>{let{children:s,className:t,...a}=e;return(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)("table",{className:(0,n.cn)("w-full border-collapse",t),...a,children:s})})},l=e=>{let{children:s,className:t,...a}=e;return(0,r.jsx)("thead",{className:(0,n.cn)("bg-gray-50",t),...a,children:s})},i=e=>{let{children:s,className:t,...a}=e;return(0,r.jsx)("tbody",{className:(0,n.cn)("bg-white divide-y divide-gray-200",t),...a,children:s})},c=e=>{let{children:s,className:t,...a}=e;return(0,r.jsx)("tr",{className:(0,n.cn)("hover:bg-gray-50 transition-colors",t),...a,children:s})},d=e=>{let{children:s,className:t,...a}=e;return(0,r.jsx)("th",{className:(0,n.cn)("px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200",t),...a,children:s})},o=e=>{let{children:s,className:t,...a}=e;return(0,r.jsx)("td",{className:(0,n.cn)("px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-200",t),...a,children:s})}}},function(e){e.O(0,[358,651,396,462,865,971,938,744],function(){return e(e.s=1572)}),_N_E=e.O()}]);