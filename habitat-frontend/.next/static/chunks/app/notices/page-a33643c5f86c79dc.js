(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[858],{9617:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(2898).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},9883:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(2898).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1138:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(2898).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},371:function(e,t,s){Promise.resolve().then(s.bind(s,3439))},3439:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var i=s(7437),a=s(2265),l=s(3779),r=s(3414),n=s(7418),c=s(6651),d=s(2278),o=s(4706),u=s(8584),x=s(492),m=s(4494),h=s(1633),p=s(9883);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let v=(0,s(2898).Z)("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);var f=s(3021),y=s(9617),j=s(1138),b=s(2169),N=s(5925);function g(){let{user:e,hasPermission:t}=(0,l.useAuth)(),[s,o]=(0,a.useState)([]),[x,g]=(0,a.useState)(!0),[k,C]=(0,a.useState)(""),[E,F]=(0,a.useState)(!1),[Z,S]=(0,a.useState)(!1),[A,M]=(0,a.useState)(null),[D,T]=(0,a.useState)({title:"",description:"",visibleFrom:"",visibleUntil:"",pinned:!1,audience:[]}),I=[{value:m.i4.ADMIN,label:"Admin"},{value:m.i4.COMMITTEE,label:"Committee"},{value:m.i4.RESIDENT,label:"Member"},{value:m.i4.TENANT,label:"Tenant"},{value:m.i4.SECURITY,label:"Security"},{value:m.i4.TECHNICIAN,label:"Technician"}];(0,a.useEffect)(()=>{t("notices:read")&&z()},[]);let z=async()=>{try{g(!0);let e=await h.E.getNotices();console.log("Fetched notices:",e),o(e.data||[])}catch(e){N.default.error("Failed to fetch notices")}finally{g(!1)}},U=async e=>{e.preventDefault();try{await h.E.createNotice(D),N.default.success("Notice created successfully"),F(!1),L(),z()}catch(e){N.default.error("Failed to create notice")}},O=async e=>{if(e.preventDefault(),A)try{await h.E.updateNotice(A._id,D),N.default.success("Notice updated successfully"),S(!1),M(null),L(),z()}catch(e){N.default.error("Failed to update notice")}},_=async e=>{if(confirm("Are you sure you want to delete this notice?"))try{await h.E.deleteNotice(e),N.default.success("Notice deleted successfully"),z()}catch(e){N.default.error("Failed to delete notice")}},L=()=>{T({title:"",description:"",visibleFrom:"",visibleUntil:"",pinned:!1,audience:[]})},q=e=>{M(e),T({title:e.title,description:e.description,visibleFrom:e.visibleFrom.split("T")[0],visibleUntil:e.visibleUntil.split("T")[0],pinned:e.pinned,audience:e.audience}),S(!0)},V=(s||[]).filter(e=>e.title.toLowerCase().includes(k.toLowerCase())||e.description.toLowerCase().includes(k.toLowerCase())),P=e=>{let t=new Date,s=new Date(e.visibleFrom),i=new Date(e.visibleUntil);return t>=s&&t<=i};return t("notices:read")?(0,i.jsxs)(r.A,{children:[(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Notices"}),t("notices:write")&&(0,i.jsxs)(c.z,{onClick:()=>F(!0),children:[(0,i.jsx)(p.Z,{className:"w-4 h-4 mr-2"})," Create Notice"]})]}),(0,i.jsx)(n.Zb,{children:(0,i.jsx)(n.aY,{className:"p-6",children:(0,i.jsx)(d.I,{placeholder:"Search notices...",value:k,onChange:e=>C(e.target.value)})})}),(0,i.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x?(0,i.jsx)("div",{className:"col-span-full text-center py-8",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto"})}):V.map(e=>(0,i.jsxs)(n.Zb,{className:"relative",children:[e.pinned&&(0,i.jsx)("div",{className:"absolute top-4 right-4",children:(0,i.jsx)(v,{className:"w-4 h-4 text-primary-600"})}),(0,i.jsx)(n.Ol,{children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsx)(n.ll,{className:"text-lg",children:e.title}),(0,i.jsx)(u.C,{variant:P(e)?"success":"default",children:P(e)?"Active":"Inactive"})]})}),(0,i.jsxs)(n.aY,{children:[(0,i.jsx)("p",{className:"text-gray-600 mb-4 line-clamp-3",children:e.description}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-gray-500",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(f.Z,{className:"w-4 h-4"}),(0,i.jsxs)("span",{children:["Visible: ",(0,b.p6)(e.visibleFrom)," - ",(0,b.p6)(e.visibleUntil)]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2",children:(0,i.jsxs)("span",{children:["Audience: ",e.audience.join(", ")]})}),(0,i.jsx)("div",{className:"flex items-center space-x-2",children:(0,i.jsxs)("span",{children:["Created: ",(0,b.o0)(e.createdAt)]})})]}),t("notices:write")&&(0,i.jsxs)("div",{className:"flex items-center space-x-2 mt-4 pt-4 border-t border-gray-200",children:[(0,i.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>q(e),children:(0,i.jsx)(y.Z,{className:"w-4 h-4"})}),(0,i.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>_(e._id),className:"text-red-600 hover:text-red-700",children:(0,i.jsx)(j.Z,{className:"w-4 h-4"})})]})]})]},e._id))}),0===V.length&&!x&&(0,i.jsx)(n.Zb,{children:(0,i.jsxs)(n.aY,{className:"p-12 text-center",children:[(0,i.jsx)(f.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No notices found"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Create your first notice to get started."})]})})]}),(0,i.jsx)(w,{isOpen:E,onClose:()=>F(!1),onSubmit:U,formData:D,setFormData:T,audienceOptions:I,title:"Create Notice"}),(0,i.jsx)(w,{isOpen:Z,onClose:()=>S(!1),onSubmit:O,formData:D,setFormData:T,audienceOptions:I,title:"Edit Notice"})]}):(0,i.jsx)(r.A,{children:(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,i.jsx)("p",{className:"text-gray-600",children:"You don't have permission to view this page."})]})})}function w(e){let{isOpen:t,onClose:s,onSubmit:a,formData:l,setFormData:r,audienceOptions:n,title:u}=e;return(0,i.jsx)(x.u,{isOpen:t,onClose:s,title:u,size:"lg",children:(0,i.jsxs)("form",{onSubmit:a,className:"space-y-4",children:[(0,i.jsx)(d.I,{label:"Title",value:l.title,onChange:e=>r(t=>({...t,title:e.target.value})),placeholder:"Enter notice title",required:!0}),(0,i.jsx)(o.g,{label:"Description",value:l.description,onChange:e=>r(t=>({...t,description:e.target.value})),placeholder:"Enter notice description",rows:4,required:!0}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsx)(d.I,{label:"Visible From",type:"date",value:l.visibleFrom,onChange:e=>r(t=>({...t,visibleFrom:e.target.value})),required:!0}),(0,i.jsx)(d.I,{label:"Visible Until",type:"date",value:l.visibleUntil,onChange:e=>r(t=>({...t,visibleUntil:e.target.value})),required:!0})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Audience"}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-2",children:n.map(e=>(0,i.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",{type:"checkbox",checked:l.audience.includes(e.value),onChange:t=>{t.target.checked?r(t=>({...t,audience:[...t.audience,e.value]})):r(t=>({...t,audience:t.audience.filter(t=>t!==e.value)}))},className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,i.jsx)("span",{className:"text-sm text-gray-700",children:e.label})]},e.value))})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("input",{type:"checkbox",id:"pinned",checked:l.pinned,onChange:e=>r(t=>({...t,pinned:e.target.checked})),className:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"}),(0,i.jsx)("label",{htmlFor:"pinned",className:"text-sm font-medium text-gray-700",children:"Pin this notice"})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,i.jsx)(c.z,{type:"button",variant:"outline",onClick:s,children:"Cancel"}),(0,i.jsxs)(c.z,{type:"submit",children:[u.includes("Create")?"Create":"Update"," Notice"]})]})]})})}},2278:function(e,t,s){"use strict";s.d(t,{I:function(){return l}});var i=s(7437);s(2265);var a=s(2169);let l=e=>{let{label:t,error:s,helperText:l,className:r,id:n,...c}=e,d=n||"input-".concat(Math.random().toString(36).substr(2,9));return(0,i.jsxs)("div",{className:"space-y-2",children:[t&&(0,i.jsx)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700",children:t}),(0,i.jsx)("input",{id:d,className:(0,a.cn)("w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",s&&"border-red-500 focus:ring-red-500",r),...c}),s&&(0,i.jsx)("p",{className:"text-sm text-red-600",children:s}),l&&!s&&(0,i.jsx)("p",{className:"text-sm text-gray-500",children:l})]})}},492:function(e,t,s){"use strict";s.d(t,{u:function(){return n}});var i=s(7437),a=s(2265),l=s(2169),r=s(2549);let n=e=>{let{isOpen:t,onClose:s,title:n,children:c,size:d="md"}=e;return((0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,s]),t)?(0,i.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,i.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:s}),(0,i.jsxs)("div",{className:(0,l.cn)("relative bg-white rounded-lg shadow-xl w-full",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[d]),children:[n&&(0,i.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:n}),(0,i.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,i.jsx)(r.Z,{className:"h-5 w-5"})})]}),(0,i.jsx)("div",{className:"p-6",children:c})]})]})}):null}},4706:function(e,t,s){"use strict";s.d(t,{g:function(){return l}});var i=s(7437);s(2265);var a=s(2169);let l=e=>{let{label:t,error:s,helperText:l,className:r,id:n,...c}=e,d=n||"textarea-".concat(Math.random().toString(36).substr(2,9));return(0,i.jsxs)("div",{className:"space-y-2",children:[t&&(0,i.jsx)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700",children:t}),(0,i.jsx)("textarea",{id:d,className:(0,a.cn)("w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-vertical",s&&"border-red-500 focus:ring-red-500",r),...c}),s&&(0,i.jsx)("p",{className:"text-sm text-red-600",children:s}),l&&!s&&(0,i.jsx)("p",{className:"text-sm text-gray-500",children:l})]})}}},function(e){e.O(0,[358,651,396,462,865,971,938,744],function(){return e(e.s=371)}),_N_E=e.O()}]);