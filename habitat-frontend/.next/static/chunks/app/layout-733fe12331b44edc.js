(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{6879:function(e,t,s){Promise.resolve().then(s.t.bind(s,3649,23)),Promise.resolve().then(s.bind(s,5925)),Promise.resolve().then(s.t.bind(s,3385,23)),Promise.resolve().then(s.bind(s,3779))},3779:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return l},useAuth:function(){return u}});var i=s(7437),a=s(2265),r=s(4494),n=s(1633),o=s(1490),c=s(5925);let d=(0,a.createContext)(void 0),u=()=>{let e=(0,a.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:t}=e,[s,u]=(0,a.useState)(null),[l,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{let e=o.Z.get("accessToken");if(e)try{let t=await fetch("".concat("http://localhost:5000/api","/users/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();e.success?u(e.data):(o.Z.remove("accessToken"),o.Z.remove("refreshToken"))}else o.Z.remove("accessToken"),o.Z.remove("refreshToken")}catch(e){console.error("Auth init error:",e),o.Z.remove("accessToken"),o.Z.remove("refreshToken")}h(!1)})()},[]);let p=async(e,t)=>{try{let s=await n.E.login(e,t);if(console.log("Login response:",s),!s.success)return c.default.error(s.message||"Login failed"),!1;let{user:i,token:a}=s.data;return u(i),o.Z.set("accessToken",a,{expires:7}),c.default.success("Login successful!"),!0}catch(e){var s,i;return console.error("Login error:",e),c.default.error((null===(i=e.response)||void 0===i?void 0:null===(s=i.data)||void 0===s?void 0:s.message)||"Login failed"),!1}},g=async e=>{try{let t=await n.E.register(e);if(console.log("Register response:",t),!t.success)return c.default.error(t.message),!1;let{user:s,token:i}=t.data;return u(s),o.Z.set("accessToken",i,{expires:7}),c.default.success(t.message||"Registration successful!"),!0}catch(e){var t,s;return console.error("Registration error:",e),c.default.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Registration failed"),!1}},f=async()=>{try{await n.E.logout()}catch(e){}finally{u(null),o.Z.remove("accessToken"),o.Z.remove("refreshToken"),c.default.success("Logged out successfully")}};return(0,i.jsx)(d.Provider,{value:{user:s,isLoading:l,login:p,register:g,logout:f,hasRole:e=>!!s&&e.includes(s.role),hasPermission:e=>{var t;return!!s&&((null===(t=({[r.i4.ADMIN]:["users:read","users:write","users:delete","bills:read","bills:write","bills:delete","notices:read","notices:write","notices:delete","amenities:read","amenities:write","amenities:delete","bookings:read","bookings:write","bookings:delete","issues:read","issues:write","issues:delete","tickets:read","tickets:write","tickets:delete","visitors:read","visitors:write","technicians:read","technicians:write","technicians:delete","payments:read"],[r.i4.COMMITTEE]:["users:read","users:write","bills:read","bills:write","notices:read","notices:write","notices:delete","amenities:read","amenities:write","amenities:delete","bookings:read","bookings:write","bookings:delete","issues:read","issues:write","issues:delete","tickets:read","tickets:write","tickets:delete","visitors:read","visitors:write","technicians:read","technicians:write","technicians:delete","payments:read"],[r.i4.RESIDENT]:["bills:read","bills:write","notices:read","amenities:read","bookings:read","bookings:write","issues:read","issues:write","visitors:read","visitors:write","payments:read"],[r.i4.TENANT]:["bills:read","bills:write","notices:read","amenities:read","bookings:read","bookings:write","issues:read","issues:write","visitors:read","visitors:write","payments:read"],[r.i4.SECURITY]:["notices:read","visitors:read","visitors:write"],[r.i4.TECHNICIAN]:["notices:read","tickets:read","tickets:write"]})[s.role])||void 0===t?void 0:t.includes(e))||!1)}},children:t})}},1633:function(e,t,s){"use strict";s.d(t,{E:function(){return n}});var i=s(4829),a=s(1490);class r{login(e,t){return this.api.post("/auth/login",{email:e,password:t}).then(e=>e.data)}register(e){return this.api.post("/auth/register",e).then(e=>e.data)}logout(){let e=a.Z.get("refreshToken");return e&&this.api.post("/auth/logout",{refreshToken:e}),a.Z.remove("accessToken"),a.Z.remove("refreshToken"),Promise.resolve()}createUser(e){return this.api.post("/users",e).then(e=>e.data)}getUsers(){return this.api.get("/users").then(e=>e.data)}getUserById(e){return this.api.get("/users/".concat(e)).then(e=>e.data)}updateUser(e,t){return this.api.put("/users/".concat(e),t).then(e=>e.data)}deleteUser(e){return this.api.delete("/users/".concat(e)).then(e=>e.data)}getIssues(e){return this.api.get("/issues",{params:e}).then(e=>e.data.data)}getIssueById(e){return this.api.get("/issues/".concat(e)).then(e=>e.data.data)}createIssue(e){return this.api.post("/issues",e).then(e=>e.data.data)}updateIssue(e,t){return this.api.patch("/issues/".concat(e),t).then(e=>e.data.data)}deleteIssue(e){return this.api.delete("/issues/".concat(e)).then(e=>e.data)}getNotices(e){return this.api.get("/notices",{params:e}).then(e=>e.data)}getNoticeById(e){return this.api.get("/notices/".concat(e)).then(e=>e.data)}createNotice(e){return this.api.post("/notices",e).then(e=>e.data)}updateNotice(e,t){return this.api.patch("/notices/".concat(e),t).then(e=>e.data)}deleteNotice(e){return this.api.delete("/notices/".concat(e)).then(e=>e.data)}getBills(e){return this.api.get("/bills",{params:e}).then(e=>e.data.data)}getBillById(e){return this.api.get("/bills/".concat(e)).then(e=>e.data.data)}createBill(e){return this.api.post("/bills",e).then(e=>e.data)}updateBill(e,t){return this.api.put("/bills/".concat(e),t).then(e=>e.data)}deleteBill(e){return this.api.delete("/bills/".concat(e)).then(e=>e.data)}payBill(e,t,s){return this.api.patch("/bills/".concat(e,"/pay"),{amount:t,gatewayRef:s}).then(e=>e.data)}generateBills(e){return this.api.post("/bills/generate",e).then(e=>e.data)}async getPayments(e){try{return(await this.api.get("/payments",{params:e})).data}catch(e){throw console.error("Failed to fetch payments:",e),e}}getAmenities(){return this.api.get("/amenities").then(e=>e.data)}createAmenity(e){return this.api.post("/amenities",e).then(e=>e.data)}updateAmenity(e,t){return this.api.put("/amenities/".concat(e),t).then(e=>e.data)}deleteAmenity(e){return this.api.delete("/amenities/".concat(e)).then(e=>e.data)}getBookings(e){return this.api.get("/bookings",{params:e}).then(e=>e.data.data)}createBooking(e){return this.api.post("/bookings",e).then(e=>e.data)}updateBooking(e,t){return this.api.put("/bookings/".concat(e),t).then(e=>e.data)}approveBooking(e,t){return this.api.patch("/bookings/".concat(e,"/approve"),{status:t}).then(e=>e.data)}updateBookingStatus(e,t){return this.api.patch("/bookings/".concat(e,"/"),{status:t}).then(e=>e.data)}getVisitors(e){return this.api.get("/visitors",{params:e}).then(e=>e.data.data)}createVisitor(e){return this.api.post("/visitors",e).then(e=>e.data.data)}checkoutVisitor(e){return this.api.patch("/visitors/".concat(e,"/checkout")).then(e=>e.data.data)}getTechnicians(){return this.api.get("/technicians").then(e=>e.data.data)}createTechnician(e){return this.api.post("/technicians",e).then(e=>e.data.data)}updateTechnician(e,t){return this.api.put("/technicians/".concat(e),t).then(e=>e.data)}deleteTechnician(e){return this.api.delete("/technicians/".concat(e)).then(e=>e.data)}constructor(){this.api=i.Z.create({baseURL:"http://localhost:5000/api",timeout:1e4}),this.api.interceptors.request.use(e=>{let t=a.Z.get("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),this.api.interceptors.response.use(e=>e,async e=>{var t;let s=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!s._retry){s._retry=!0;try{let e=a.Z.get("refreshToken");if(!e)throw Error("No refresh token found");let{accessToken:t}=(await i.Z.post("".concat(this.api.defaults.baseURL,"/auth/refresh"),{refreshToken:e})).data.data;return a.Z.set("accessToken",t,{expires:7}),s.headers.Authorization="Bearer ".concat(t),this.api(s)}catch(e){a.Z.remove("accessToken"),a.Z.remove("refreshToken"),window.location.href="/login"}}return Promise.reject(e)})}}let n=new r},4494:function(e,t,s){"use strict";var i,a,r,n,o,c,d,u,l,h,p,g;s.d(t,{bG:function(){return c},d$:function(){return r},gn:function(){return o},i4:function(){return i}}),(d=i||(i={})).ADMIN="admin",d.COMMITTEE="committee",d.RESIDENT="resident",d.TENANT="tenant",d.SECURITY="security",d.TECHNICIAN="technician",(u=a||(a={})).MALE="male",u.FEMALE="female",u.OTHER="other",(l=r||(r={})).OPEN="open",l.IN_PROGRESS="in_progress",l.RESOLVED="resolved",l.CLOSED="closed",(h=n||(n={})).PENDING="pending",h.ASSIGNED="assigned",h.IN_PROGRESS="in_progress",h.COMPLETED="completed",h.CANCELLED="cancelled",(p=o||(o={})).PENDING="pending",p.APPROVED="approved",p.REJECTED="rejected",p.CANCELLED="cancelled",(g=c||(c={})).PENDING="Pending",g.COMPLETED="Completed",g.FAILED="Failed",g.REFUNDED="Refunded"},3385:function(){},3649:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[358,971,938,744],function(){return e(e.s=6879)}),_N_E=e.O()}]);