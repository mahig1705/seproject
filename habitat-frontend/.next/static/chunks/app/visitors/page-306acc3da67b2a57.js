(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{3008:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6141:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},9883:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1827:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(2898).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},4512:function(e,s,t){Promise.resolve().then(t.bind(t,5011))},5011:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var r=t(7437),i=t(2265),l=t(3779),n=t(3414),c=t(7418),a=t(6651),d=t(2278),o=t(8584),u=t(492),x=t(200),h=t(1633),m=t(9883),j=t(2527),f=t(6141),p=t(3008),v=t(1827),y=t(2169),g=t(5925);function b(){let{hasPermission:e}=(0,l.useAuth)(),[s,t]=(0,i.useState)([]),[b,N]=(0,i.useState)(!0),[w,k]=(0,i.useState)(""),[C,Z]=(0,i.useState)(""),[S,V]=(0,i.useState)(!1),[T,L]=(0,i.useState)(!1),[_,A]=(0,i.useState)(null),[E,z]=(0,i.useState)({name:"",flatNumber:"",vehicle:"",purpose:""});(0,i.useEffect)(()=>{e("visitors:read")&&I()},[]);let I=async()=>{try{N(!0);let e=await h.E.getVisitors();t(Array.isArray(e)?e:e.data||[])}catch(e){console.error(e),g.default.error("Failed to fetch visitors")}finally{N(!1)}},F=async e=>{e.preventDefault();try{await h.E.createVisitor(E),g.default.success("Visitor logged successfully"),V(!1),q(),I()}catch(e){g.default.error("Failed to log visitor")}},O=async e=>{if(e.preventDefault(),_)try{await h.E.checkoutVisitor(_._id),g.default.success("Visitor checked out successfully"),L(!1),A(null),I()}catch(e){g.default.error("Failed to checkout visitor")}},q=()=>{z({name:"",flatNumber:"",vehicle:"",purpose:""})},M=e=>{A(e),L(!0)},Y=(s||[]).filter(e=>{var s,t,r;let i=(null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes(w.toLowerCase()))||(null===(t=e.purpose)||void 0===t?void 0:t.toLowerCase().includes(w.toLowerCase()))||(null===(r=e.flatNumber)||void 0===r?void 0:r.toLowerCase().includes(w.toLowerCase())),l=!C||"active"===C&&!e.outTime||"checked_out"===C&&e.outTime;return i&&l}),D=e=>e.outTime?"checked_out":"active",P=e=>{switch(e){case"active":return"warning";case"checked_out":return"success";default:return"default"}};return e("visitors:read")?(0,r.jsxs)(n.A,{children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Visitors"}),e("visitors:write")&&(0,r.jsxs)(a.z,{onClick:()=>V(!0),children:[(0,r.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"Log Visitor"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)(c.Zb,{children:(0,r.jsxs)(c.aY,{className:"p-6 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Total Visitors"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:s.length})]}),(0,r.jsx)(j.Z,{className:"w-8 h-8 text-blue-600"})]})}),(0,r.jsx)(c.Zb,{children:(0,r.jsxs)(c.aY,{className:"p-6 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Active Visitors"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:s.filter(e=>!e.outTime).length})]}),(0,r.jsx)(f.Z,{className:"w-8 h-8 text-orange-600"})]})}),(0,r.jsx)(c.Zb,{children:(0,r.jsxs)(c.aY,{className:"p-6 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Checked Out"}),(0,r.jsx)("p",{className:"text-2xl font-bold",children:s.filter(e=>e.outTime).length})]}),(0,r.jsx)(p.Z,{className:"w-8 h-8 text-green-600"})]})})]}),(0,r.jsx)(c.Zb,{children:(0,r.jsx)(c.aY,{className:"p-6 flex items-center space-x-4",children:(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(d.I,{placeholder:"Search visitors...",value:w,onChange:e=>k(e.target.value)}),(0,r.jsx)(v.Z,{className:"w-4 h-4 absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})})}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{children:["All Visitors (",Y.length,")"]})}),(0,r.jsx)(c.aY,{children:b?(0,r.jsx)("div",{className:"text-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"})}):(0,r.jsxs)(x.iA,{children:[(0,r.jsx)(x.xD,{children:(0,r.jsxs)(x.SC,{children:[(0,r.jsx)(x.ss,{children:"Name"}),(0,r.jsx)(x.ss,{children:"Flat"}),(0,r.jsx)(x.ss,{children:"Purpose"}),(0,r.jsx)(x.ss,{children:"Vehicle"}),(0,r.jsx)(x.ss,{children:"In Time"}),(0,r.jsx)(x.ss,{children:"Out Time"}),(0,r.jsx)(x.ss,{children:"Status"}),(0,r.jsx)(x.ss,{children:"Actions"})]})}),(0,r.jsx)(x.RM,{children:Y.map(s=>(0,r.jsxs)(x.SC,{children:[(0,r.jsx)(x.pj,{children:s.name}),(0,r.jsx)(x.pj,{children:s.flatNumber||"-"}),(0,r.jsx)(x.pj,{children:s.purpose}),(0,r.jsx)(x.pj,{children:s.vehicle||"-"}),(0,r.jsx)(x.pj,{children:(0,y.o0)(s.inTime)}),(0,r.jsx)(x.pj,{children:s.outTime?(0,y.o0)(s.outTime):"-"}),(0,r.jsx)(x.pj,{children:(0,r.jsx)(o.C,{variant:P(D(s)),children:D(s).replace("_"," ")})}),(0,r.jsx)(x.pj,{children:!s.outTime&&e("visitors:write")&&(0,r.jsx)(a.z,{variant:"outline",size:"sm",onClick:()=>M(s),children:"Checkout"})})]},s._id))})]})})]})]}),(0,r.jsx)(u.u,{isOpen:S,onClose:()=>V(!1),title:"Log New Visitor",children:(0,r.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,r.jsx)(d.I,{label:"Visitor Name",value:E.name,onChange:e=>z(s=>({...s,name:e.target.value})),required:!0}),(0,r.jsx)(d.I,{label:"Flat Number",value:E.flatNumber,onChange:e=>z(s=>({...s,flatNumber:e.target.value})),required:!0}),(0,r.jsx)(d.I,{label:"Vehicle",value:E.vehicle,onChange:e=>z(s=>({...s,vehicle:e.target.value}))}),(0,r.jsx)(d.I,{label:"Purpose",value:E.purpose,onChange:e=>z(s=>({...s,purpose:e.target.value})),required:!0}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)(a.z,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),(0,r.jsx)(a.z,{type:"submit",children:"Log Visitor"})]})]})}),(0,r.jsx)(u.u,{isOpen:T,onClose:()=>L(!1),title:"Checkout Visitor",children:_&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Name:"})," ",_.name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Flat:"})," ",_.flatNumber]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Purpose:"})," ",_.purpose]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"In Time:"})," ",(0,y.o0)(_.inTime)]})]}),(0,r.jsx)("form",{onSubmit:O,children:(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)(a.z,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),(0,r.jsx)(a.z,{type:"submit",children:"Checkout"})]})})]})})]}):(0,r.jsx)(n.A,{children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,r.jsx)("p",{className:"text-gray-600",children:"You don't have permission to view this page."})]})})}},2278:function(e,s,t){"use strict";t.d(s,{I:function(){return l}});var r=t(7437);t(2265);var i=t(2169);let l=e=>{let{label:s,error:t,helperText:l,className:n,id:c,...a}=e,d=c||"input-".concat(Math.random().toString(36).substr(2,9));return(0,r.jsxs)("div",{className:"space-y-2",children:[s&&(0,r.jsx)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700",children:s}),(0,r.jsx)("input",{id:d,className:(0,i.cn)("w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",t&&"border-red-500 focus:ring-red-500",n),...a}),t&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:t}),l&&!t&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:l})]})}},492:function(e,s,t){"use strict";t.d(s,{u:function(){return c}});var r=t(7437),i=t(2265),l=t(2169),n=t(2549);let c=e=>{let{isOpen:s,onClose:t,title:c,children:a,size:d="md"}=e;return((0,i.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,t]),s)?(0,r.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),(0,r.jsxs)("div",{className:(0,l.cn)("relative bg-white rounded-lg shadow-xl w-full",{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[d]),children:[c&&(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:c}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)(n.Z,{className:"h-5 w-5"})})]}),(0,r.jsx)("div",{className:"p-6",children:a})]})]})}):null}},200:function(e,s,t){"use strict";t.d(s,{RM:function(){return c},SC:function(){return a},iA:function(){return l},pj:function(){return o},ss:function(){return d},xD:function(){return n}});var r=t(7437);t(2265);var i=t(2169);let l=e=>{let{children:s,className:t,...l}=e;return(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)("table",{className:(0,i.cn)("w-full border-collapse",t),...l,children:s})})},n=e=>{let{children:s,className:t,...l}=e;return(0,r.jsx)("thead",{className:(0,i.cn)("bg-gray-50",t),...l,children:s})},c=e=>{let{children:s,className:t,...l}=e;return(0,r.jsx)("tbody",{className:(0,i.cn)("bg-white divide-y divide-gray-200",t),...l,children:s})},a=e=>{let{children:s,className:t,...l}=e;return(0,r.jsx)("tr",{className:(0,i.cn)("hover:bg-gray-50 transition-colors",t),...l,children:s})},d=e=>{let{children:s,className:t,...l}=e;return(0,r.jsx)("th",{className:(0,i.cn)("px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b border-gray-200",t),...l,children:s})},o=e=>{let{children:s,className:t,...l}=e;return(0,r.jsx)("td",{className:(0,i.cn)("px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-b border-gray-200",t),...l,children:s})}}},function(e){e.O(0,[358,651,396,462,865,971,938,744],function(){return e(e.s=4512)}),_N_E=e.O()}]);