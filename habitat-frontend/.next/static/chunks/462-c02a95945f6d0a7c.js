"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[462],{6651:function(e,t,r){r.d(t,{z:function(){return a}});var i=r(7437);r(2265);var s=r(2169);let a=e=>{let{variant:t="primary",size:r="md",loading:a=!1,className:n,children:o,disabled:c,...u}=e;return(0,i.jsxs)("button",{className:(0,s.cn)("inline-flex items-center justify-center rounded-lg font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-gray-500"}[t],{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[r],n),disabled:c||a,...u,children:[a&&(0,i.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,i.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,i.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o]})}},7418:function(e,t,r){r.d(t,{Ol:function(){return n},Zb:function(){return a},aY:function(){return c},ll:function(){return o}});var i=r(7437);r(2265);var s=r(2169);let a=e=>{let{children:t,className:r,...a}=e;return(0,i.jsx)("div",{className:(0,s.cn)("bg-white rounded-lg shadow-sm border border-gray-200 p-6",r),...a,children:t})},n=e=>{let{children:t,className:r,...a}=e;return(0,i.jsx)("div",{className:(0,s.cn)("flex items-center justify-between mb-4",r),...a,children:t})},o=e=>{let{children:t,className:r,...a}=e;return(0,i.jsx)("h3",{className:(0,s.cn)("text-lg font-semibold text-gray-900",r),...a,children:t})},c=e=>{let{children:t,className:r,...a}=e;return(0,i.jsx)("div",{className:(0,s.cn)("text-gray-600",r),...a,children:t})}},3779:function(e,t,r){r.r(t),r.d(t,{AuthProvider:function(){return l},useAuth:function(){return d}});var i=r(7437),s=r(2265),a=r(4494),n=r(1633),o=r(1490),c=r(5925);let u=(0,s.createContext)(void 0),d=()=>{let e=(0,s.useContext)(u);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:t}=e,[r,d]=(0,s.useState)(null),[l,h]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{let e=o.Z.get("accessToken");if(e)try{let t=await fetch("".concat("http://localhost:5000/api","/users/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();e.success?d(e.data):(o.Z.remove("accessToken"),o.Z.remove("refreshToken"))}else o.Z.remove("accessToken"),o.Z.remove("refreshToken")}catch(e){console.error("Auth init error:",e),o.Z.remove("accessToken"),o.Z.remove("refreshToken")}h(!1)})()},[]);let p=async(e,t)=>{try{let r=await n.E.login(e,t);if(console.log("Login response:",r),!r.success)return c.default.error(r.message||"Login failed"),!1;let{user:i,token:s}=r.data;return d(i),o.Z.set("accessToken",s,{expires:7}),c.default.success("Login successful!"),!0}catch(e){var r,i;return console.error("Login error:",e),c.default.error((null===(i=e.response)||void 0===i?void 0:null===(r=i.data)||void 0===r?void 0:r.message)||"Login failed"),!1}},g=async e=>{try{let t=await n.E.register(e);if(console.log("Register response:",t),!t.success)return c.default.error(t.message),!1;let{user:r,token:i}=t.data;return d(r),o.Z.set("accessToken",i,{expires:7}),c.default.success(t.message||"Registration successful!"),!0}catch(e){var t,r;return console.error("Registration error:",e),c.default.error((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Registration failed"),!1}},m=async()=>{try{await n.E.logout()}catch(e){}finally{d(null),o.Z.remove("accessToken"),o.Z.remove("refreshToken"),c.default.success("Logged out successfully")}};return(0,i.jsx)(u.Provider,{value:{user:r,isLoading:l,login:p,register:g,logout:m,hasRole:e=>!!r&&e.includes(r.role),hasPermission:e=>{var t;return!!r&&((null===(t=({[a.i4.ADMIN]:["users:read","users:write","users:delete","bills:read","bills:write","bills:delete","notices:read","notices:write","notices:delete","amenities:read","amenities:write","amenities:delete","bookings:read","bookings:write","bookings:delete","issues:read","issues:write","issues:delete","tickets:read","tickets:write","tickets:delete","visitors:read","visitors:write","technicians:read","technicians:write","technicians:delete","payments:read"],[a.i4.COMMITTEE]:["users:read","users:write","bills:read","bills:write","notices:read","notices:write","notices:delete","amenities:read","amenities:write","amenities:delete","bookings:read","bookings:write","bookings:delete","issues:read","issues:write","issues:delete","tickets:read","tickets:write","tickets:delete","visitors:read","visitors:write","technicians:read","technicians:write","technicians:delete","payments:read"],[a.i4.RESIDENT]:["bills:read","bills:write","notices:read","amenities:read","bookings:read","bookings:write","issues:read","issues:write","visitors:read","visitors:write","payments:read"],[a.i4.TENANT]:["bills:read","bills:write","notices:read","amenities:read","bookings:read","bookings:write","issues:read","issues:write","visitors:read","visitors:write","payments:read"],[a.i4.SECURITY]:["notices:read","visitors:read","visitors:write"],[a.i4.TECHNICIAN]:["notices:read","tickets:read","tickets:write"]})[r.role])||void 0===t?void 0:t.includes(e))||!1)}},children:t})}},2169:function(e,t,r){r.d(t,{cn:function(){return a},o0:function(){return o},p6:function(){return n},xG:function(){return c}});var i=r(7042),s=r(4769);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,i.W)(t))}function n(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function o(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function c(e){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e)}},1633:function(e,t,r){r.d(t,{E:function(){return n}});var i=r(4829),s=r(1490);class a{login(e,t){return this.api.post("/auth/login",{email:e,password:t}).then(e=>e.data)}register(e){return this.api.post("/auth/register",e).then(e=>e.data)}logout(){let e=s.Z.get("refreshToken");return e&&this.api.post("/auth/logout",{refreshToken:e}),s.Z.remove("accessToken"),s.Z.remove("refreshToken"),Promise.resolve()}createUser(e){return this.api.post("/users",e).then(e=>e.data)}getUsers(){return this.api.get("/users").then(e=>e.data)}getUserById(e){return this.api.get("/users/".concat(e)).then(e=>e.data)}updateUser(e,t){return this.api.put("/users/".concat(e),t).then(e=>e.data)}deleteUser(e){return this.api.delete("/users/".concat(e)).then(e=>e.data)}getIssues(e){return this.api.get("/issues",{params:e}).then(e=>e.data.data)}getIssueById(e){return this.api.get("/issues/".concat(e)).then(e=>e.data.data)}createIssue(e){return this.api.post("/issues",e).then(e=>e.data.data)}updateIssue(e,t){return this.api.patch("/issues/".concat(e),t).then(e=>e.data.data)}deleteIssue(e){return this.api.delete("/issues/".concat(e)).then(e=>e.data)}getNotices(e){return this.api.get("/notices",{params:e}).then(e=>e.data)}getNoticeById(e){return this.api.get("/notices/".concat(e)).then(e=>e.data)}createNotice(e){return this.api.post("/notices",e).then(e=>e.data)}updateNotice(e,t){return this.api.patch("/notices/".concat(e),t).then(e=>e.data)}deleteNotice(e){return this.api.delete("/notices/".concat(e)).then(e=>e.data)}getBills(e){return this.api.get("/bills",{params:e}).then(e=>e.data.data)}getBillById(e){return this.api.get("/bills/".concat(e)).then(e=>e.data.data)}createBill(e){return this.api.post("/bills",e).then(e=>e.data)}updateBill(e,t){return this.api.put("/bills/".concat(e),t).then(e=>e.data)}deleteBill(e){return this.api.delete("/bills/".concat(e)).then(e=>e.data)}payBill(e,t,r){return this.api.patch("/bills/".concat(e,"/pay"),{amount:t,gatewayRef:r}).then(e=>e.data)}generateBills(e){return this.api.post("/bills/generate",e).then(e=>e.data)}async getPayments(e){try{return(await this.api.get("/payments",{params:e})).data}catch(e){throw console.error("Failed to fetch payments:",e),e}}getAmenities(){return this.api.get("/amenities").then(e=>e.data)}createAmenity(e){return this.api.post("/amenities",e).then(e=>e.data)}updateAmenity(e,t){return this.api.put("/amenities/".concat(e),t).then(e=>e.data)}deleteAmenity(e){return this.api.delete("/amenities/".concat(e)).then(e=>e.data)}getBookings(e){return this.api.get("/bookings",{params:e}).then(e=>e.data.data)}createBooking(e){return this.api.post("/bookings",e).then(e=>e.data)}updateBooking(e,t){return this.api.put("/bookings/".concat(e),t).then(e=>e.data)}approveBooking(e,t){return this.api.patch("/bookings/".concat(e,"/approve"),{status:t}).then(e=>e.data)}updateBookingStatus(e,t){return this.api.patch("/bookings/".concat(e,"/"),{status:t}).then(e=>e.data)}getVisitors(e){return this.api.get("/visitors",{params:e}).then(e=>e.data.data)}createVisitor(e){return this.api.post("/visitors",e).then(e=>e.data.data)}checkoutVisitor(e){return this.api.patch("/visitors/".concat(e,"/checkout")).then(e=>e.data.data)}getTechnicians(){return this.api.get("/technicians").then(e=>e.data.data)}createTechnician(e){return this.api.post("/technicians",e).then(e=>e.data.data)}updateTechnician(e,t){return this.api.put("/technicians/".concat(e),t).then(e=>e.data)}deleteTechnician(e){return this.api.delete("/technicians/".concat(e)).then(e=>e.data)}constructor(){this.api=i.Z.create({baseURL:"http://localhost:5000/api",timeout:1e4}),this.api.interceptors.request.use(e=>{let t=s.Z.get("accessToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),this.api.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let e=s.Z.get("refreshToken");if(!e)throw Error("No refresh token found");let{accessToken:t}=(await i.Z.post("".concat(this.api.defaults.baseURL,"/auth/refresh"),{refreshToken:e})).data.data;return s.Z.set("accessToken",t,{expires:7}),r.headers.Authorization="Bearer ".concat(t),this.api(r)}catch(e){s.Z.remove("accessToken"),s.Z.remove("refreshToken"),window.location.href="/login"}}return Promise.reject(e)})}}let n=new a},4494:function(e,t,r){var i,s,a,n,o,c,u,d,l,h,p,g;r.d(t,{bG:function(){return c},d$:function(){return a},gn:function(){return o},i4:function(){return i}}),(u=i||(i={})).ADMIN="admin",u.COMMITTEE="committee",u.RESIDENT="resident",u.TENANT="tenant",u.SECURITY="security",u.TECHNICIAN="technician",(d=s||(s={})).MALE="male",d.FEMALE="female",d.OTHER="other",(l=a||(a={})).OPEN="open",l.IN_PROGRESS="in_progress",l.RESOLVED="resolved",l.CLOSED="closed",(h=n||(n={})).PENDING="pending",h.ASSIGNED="assigned",h.IN_PROGRESS="in_progress",h.COMPLETED="completed",h.CANCELLED="cancelled",(p=o||(o={})).PENDING="pending",p.APPROVED="approved",p.REJECTED="rejected",p.CANCELLED="cancelled",(g=c||(c={})).PENDING="Pending",g.COMPLETED="Completed",g.FAILED="Failed",g.REFUNDED="Refunded"}}]);